<script>
const chatBox = document.getElementById("chat-box");
const userInput = document.getElementById("userInput");
const cartCount = document.getElementById("cartCount");

const inventory=[
 {id:1,name:"Velvet Anarkali",price:"â‚¹4,200",fabric:"Premium Velvet",sizes:["S","M","L","XL"],colors:["Maroon","Black","Green"]},
 {id:2,name:"Silk Party Gown",price:"â‚¹5,500",fabric:"Pure Silk",sizes:["M","L"],colors:["Rose Pink","Gold"]},
 {id:3,name:"Floral Summer Dress",price:"â‚¹2,800",fabric:"Cotton Blend",sizes:["S","M","L"],colors:["Yellow","White","Peach"]}
];

let selectedProduct=null;
let selectedSize=null;
let cart=[];
let waitingForOrderId=false;

function addMessage(text,sender){
  const div=document.createElement("div");
  div.className=`msg ${sender}`;
  div.innerHTML=text;
  chatBox.appendChild(div);
  chatBox.scrollTop=chatBox.scrollHeight;
}

/* ---------------- BASIC INFO ---------------- */

function showBoutiqueInfo(){
  addMessage(`
    ğŸª <b>About Our Boutique</b><br>
    ğŸŒ¸ Premium Women's Ethnic & Party Wear<br>
    ğŸ“ Location: Chennai, India<br>
    ğŸ•˜ Open: 10 AM â€“ 9 PM (All Days)<br>
    ğŸ“ Support: +91 98765 43210
  `,"bot");
}

function showSizeGuide(){
  addMessage(`
    ğŸ“ <b>Size Guide</b><br>
    S: Bust 34â€“36<br>
    M: Bust 38â€“40<br>
    L: Bust 42â€“44<br>
    XL: Bust 46â€“48<br><br>
    Need help choosing size? Just ask ğŸ˜Š
  `,"bot");
}

function showOffers(){
  addMessage(`
    ğŸ <b>Current Offers</b><br>
    âœ¨ Flat 10% OFF on first order<br>
    ğŸšš Free Delivery on orders above â‚¹3,000<br>
    ğŸ‰ Festival Sale coming soon!
  `,"bot");
}

function showPolicies(){
  addMessage(`
    ğŸšš <b>Shipping & Returns</b><br>
    â€¢ Delivery in 3â€“5 working days<br>
    â€¢ 7-day easy return<br>
    â€¢ Exchange available for size issues
  `,"bot");
}

/* ---------------- SHOP FLOW ---------------- */

function showCatalog(){
  let html="<b>Tap a dress to view details:</b>";
  inventory.forEach(p=>{
    html+=`
      <div class="product-card" onclick="selectProduct(${p.id})">
        <b>${p.name}</b><br>ğŸ’° ${p.price}
      </div>`;
  });
  addMessage(html,"bot");
}

function selectProduct(id){
  selectedProduct=inventory.find(p=>p.id===id);
  selectedSize=null;
  addMessage(`I want <b>${selectedProduct.name}</b>`,"user");

  setTimeout(()=>{
    addMessage(`
      ğŸ‘— <b>${selectedProduct.name}</b><br>
      ğŸ’° ${selectedProduct.price}<br>
      ğŸ§µ ${selectedProduct.fabric}<br>
      ğŸšš Delivery: 3â€“5 days<br>
      ğŸ” Easy return<br><br>
      <b>Select Size:</b><br>
      ${selectedProduct.sizes.map(s=>`<button class="option" onclick="selectSize('${s}')">${s}</button>`).join("")}
    `,"bot");
  },400);
}

function selectSize(size){
  selectedSize=size;
  addMessage(`Size ${size}`,"user");

  setTimeout(()=>{
    addMessage(`
      <b>Select Color:</b><br>
      ${selectedProduct.colors.map(c=>`<button class="option" onclick="selectColor('${c}')">${c}</button>`).join("")}
    `,"bot");
  },300);
}

function selectColor(color){
  addMessage(color,"user");
  cart.push({product:selectedProduct.name,size:selectedSize,color});
  cartCount.textContent=cart.length;

  setTimeout(()=>{
    addMessage(`
      âœ… <b>Added to Cart</b><br>
      ğŸ‘— ${selectedProduct.name}<br>
      ğŸ“ ${selectedSize} | ğŸ¨ ${color}<br>
      ğŸ’° ${selectedProduct.price}<br><br>
      <button class="option" onclick="showCatalog()">Continue Shopping</button>
      <button class="option" onclick="startTracking()">Track Order</button>
    `,"bot");
  },400);
}

function startTracking(){
  waitingForOrderId=true;
  addMessage("Please enter your Order ID ğŸ“¦","bot");
}

/* ---------------- CHAT LOGIC ---------------- */

function handleSend(){
  const text=userInput.value.trim();
  if(!text) return;
  addMessage(text,"user");
  userInput.value="";
  const input=text.toLowerCase();

  setTimeout(()=>{
    if(waitingForOrderId){
      waitingForOrderId=false;
      addMessage(`ğŸ” Order <b>${text}</b> is <b>Out for Delivery ğŸšš</b>`,"bot");
    }
    else if(["hi","hello","hey"].includes(input)){
      addMessage("Hey! ğŸ‘‹ How can I help you today? ğŸ’•","bot");
    }
    else if(input.includes("collection")||input.includes("dress")){
      showCatalog();
    }
    else if(input.includes("track")){
      startTracking();
    }
    else if(input.includes("cart")){
      addMessage(`ğŸ›’ You have ${cart.length} item(s) in cart`,"bot");
    }
    else if(input.includes("size")){
      showSizeGuide();
    }
    else if(input.includes("offer")||input.includes("discount")){
      showOffers();
    }
    else if(input.includes("return")||input.includes("delivery")){
      showPolicies();
    }
    else if(input.includes("about")||input.includes("boutique")){
      showBoutiqueInfo();
    }
    else{
      addMessage(
        "Sorry ğŸ˜” I can only help with <b>boutique-related queries</b> like dresses, sizes, offers, and orders ğŸ‘—",
        "bot"
      );
    }
  },350);
}

window.onload=()=>{
  addMessage(
    "Hey! ğŸ‘‹ Welcome to our Boutique ğŸ’•<br><br>Try: <b>show collection</b>, <b>offers</b>, <b>size guide</b>, or <b>track order</b>",
    "bot"
  );
};

userInput.addEventListener("keypress",e=>{
  if(e.key==="Enter") handleSend();
});
</script>
